<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- SEO Optimization -->
  <title>Pythia‚Ñ¢ - Website Performance Analysis Tool | One Score to Rank Them All</title>
  <meta name="description" content="Pythia‚Ñ¢ is the ultimate website performance oracle analyzing speed, accessibility, SEO, privacy, and sustainability. Get one unified P-Score for any website in seconds.">
  <meta name="keywords" content="website performance, one score, site speed test, SEO analyzer, accessibility checker, website security, performance testing, web optimization, P-Score">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://p-score.me/">
  <meta property="og:title" content="Pythia‚Ñ¢ - Website Performance Oracle | Scanned by Pythia‚Ñ¢ üîÆ">
  <meta property="og:description" content="Complete website performance analysis in one unified P-Score. Measure speed, accessibility, SEO, privacy, sustainability and more.">
  <meta property="og:image" content="https://p-score.me/pythia-oracle.gif">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://p-score.me/">
  <meta property="twitter:title" content="Pythia‚Ñ¢ - Website Performance Analysis Tool">
  <meta property="twitter:description" content="One score to rank them all. Complete website performance oracle. Scanned by Pythia‚Ñ¢ üîÆ">
  <meta property="twitter:image" content="https://p-score.me/pythia-oracle.gif">
  
  <!-- Canonical -->
  <meta name="canonical" href="https://p-score.me/">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* ==== NEW ENHANCEMENTS ==== */
    
    /* Loading Spinner */
    @keyframes retro-spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .retro-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #003300;
      border-top: 4px solid #00ff00;
      border-radius: 50%;
      animation: retro-spin 1s linear infinite;
      margin: 20px auto;
    }
    
    body.retro .retro-spinner {
      border: 4px solid #003300;
      border-top: 4px solid #00ff00;
      box-shadow: 0 0 20px #00ff00;
    }
    
    /* CRT Effects */
    @keyframes flicker {
      0% { opacity: 0.98; }
      5% { opacity: 1; }
      10% { opacity: 0.98; }
      15% { opacity: 1; }
      20% { opacity: 0.97; }
      25% { opacity: 1; }
      100% { opacity: 1; }
    }
    
    @keyframes scanline {
      0% { transform: translateY(-100%); }
      100% { transform: translateY(100vh); }
    }
    
    body.retro::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 255, 0, 0.03) 0px,
        rgba(0, 255, 0, 0.03) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      z-index: 9999;
      animation: flicker 0.15s infinite;
    }
    
    body.retro::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(
        to bottom,
        rgba(0, 255, 0, 0) 0%,
        rgba(0, 255, 0, 0.3) 50%,
        rgba(0, 255, 0, 0) 100%
      );
      pointer-events: none;
      z-index: 9998;
      animation: scanline 6s linear infinite;
    }
    
    /* Boot Sequence */
    @keyframes boot-fade {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }
    
    .boot-sequence {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      padding: 40px;
      z-index: 10000;
      overflow-y: auto;
      animation: boot-fade 0.5s ease-in;
    }
    
    .boot-line {
      opacity: 0;
      animation: boot-fade 0.3s ease-in forwards;
    }
    
    /* Sound Toggle */
    .sound-toggle {
      position: fixed;
      top: 20px;
      right: 80px;
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid #00ff00;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 1001;
      transition: all 0.3s ease;
    }
    
    .sound-toggle:hover {
      box-shadow: 0 0 15px #00ff00;
      transform: scale(1.1);
    }
    
    body.retro .sound-toggle {
      display: flex;
    }
    
    body:not(.retro) .sound-toggle {
      display: none;
    }
    
    /* Visit Counter */
    .visit-counter {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.8);
      color: #00ff00;
      padding: 10px 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      z-index: 1000;
      border: 2px solid #00ff00;
      box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
    }
    
    /* Collapse/Expand */
    .detail-content {
      max-height: 5000px;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
    }
    
    .detail-content.collapsed {
      max-height: 0;
    }
    
    /* Badge Styles */
    .badge-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 16px;
      padding: 30px;
      color: white;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    body.retro .badge-card {
      background: #001a00 !important;
      border: 4px solid #00ff00 !important;
      border-radius: 0 !important;
      box-shadow: 0 0 20px #00ff00 !important;
    }
    
    .badge-pscore {
      font-size: 72px;
      font-weight: bold;
      text-shadow: 0 0 20px rgba(255,255,255,0.5);
    }
    
    body.retro .badge-pscore {
      color: #00ff00 !important;
      text-shadow: 0 0 30px #00ff00 !important;
    }
    
    /* Summon Mode */
    body.summon-mode {
      background: #1a0033 !important;
      background-image: 
        repeating-linear-gradient(0deg, transparent, transparent 2px, #330066 2px, #330066 4px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, #2a0044 2px, #2a0044 4px) !important;
    }
    
    body.summon-mode .modern-card {
      border-color: #ff00ff !important;
      box-shadow: 0 0 30px #ff00ff !important;
    }
    
    body.summon-mode h1, body.summon-mode h2, body.summon-mode h3 {
      color: #ff00ff !important;
      text-shadow: 2px 2px 0 #660066, 0 0 15px #ff00ff !important;
    }
    
    body.summon-mode p, body.summon-mode div, body.summon-mode span {
      color: #ff66ff !important;
    }
    
    /* Typing Animation */
    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }
    @keyframes blink-cursor {
      from, to { border-right: 2px solid #00ff00; }
      50% { border-right: none; }
    }
    .typing-effect {
      overflow: hidden;
      border-right: 2px solid #00ff00;
      white-space: nowrap;
      animation: typing 2s steps(40, end), blink-cursor 0.75s step-end infinite;
    }

    /* Curved Distortion (subtle barrel distortion via SVG filter) */
    body.retro {
      filter: url(#curved-distortion);
    }
    svg {
      position: absolute;
      width: 0;
      height: 0;
    }
    filter#curved-distortion {
      x: -50%;
      y: -50%;
      width: 200%;
      height: 200%;
    }
    feTurbulence {
      type: fractalNoise;
      baseFrequency: 0.01;
      numOctaves: 1;
      result: noise;
    }
    feDisplacementMap {
      in: SourceGraphic;
      in2: noise;
      scale: 2;
      xChannelSelector: R;
      yChannelSelector: G;
    }

    /* Improved Contrast for Accessibility */
    :root {
      --text-high: #00ff00;
      --text-med: #33ff33;
      --bg-dark: #000;
    }
    body.retro { color: var(--text-high); background: var(--bg-dark); }
    body.retro .text-gray-600 { color: var(--text-med) !important; }
    
    /* ==== ORIGINAL STYLES FROM DOCX ==== */
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.3); }
      50% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.6); }
    }
    .scanning { animation: pulse-glow 2s infinite; }
    
    .menu-overlay {
      position: fixed; top: 0; left: -100%; width: 80%; max-width: 400px; height: 100vh;
      background: white; box-shadow: 2px 0 10px rgba(0,0,0,0.3); transition: left 0.3s ease;
      z-index: 1000; overflow-y: auto;
    }
    .menu-overlay.open { left: 0; }
    .menu-backdrop {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh; background: rgba(0,0,0,0.5);
      opacity: 0; visibility: hidden; transition: all 0.3s ease; z-index: 999;
    }
    .menu-backdrop.open { opacity: 1; visibility: visible; }
    .page-content { display: none; }
    .page-content.active { display: block; }
    
    /* Retro Mode Styles */
    body.retro {
      background: #000000 !important;
      font-family: 'Courier New', monospace !important;
      image-rendering: pixelated;
      color: #00ff00 !important;
      background-image: 
        repeating-linear-gradient(0deg, transparent, transparent 2px, #001100 2px, #001100 4px),
        repeating-linear-gradient(90deg, transparent, transparent 2px, #001100 2px, #001100 4px);
      background-size: 40px 40px;
    }
    body.retro * {
      font-family: 'Courier New', monospace !important;
      image-rendering: pixelated;
    }
    body.retro .modern-card {
      background: #0a0a0a !important;
      border: 4px solid #00ff00 !important;
      border-radius: 0 !important;
      box-shadow: 0 0 20px #00ff00 !important;
    }
    body.retro .retro-button {
      background: #003300 !important;
      border: 3px solid #00ff00 !important;
      border-radius: 0 !important;
      color: #00ff00 !important;
      font-weight: bold !important;
      padding: 8px 16px !important;
      text-shadow: 0 0 5px #00ff00;
    }
    body.retro .retro-button:hover {
      background: #005500 !important;
      box-shadow: 0 0 15px #00ff00;
    }
    body.retro #themeToggle,
    body.retro .page-content button,
    body.retro .menu-overlay button {
      background: #001a00 !important;
      color: #33ff33 !important;
      border: 2px solid #33ff33 !important;
      text-shadow: 0 0 3px #33ff33 !important;
    }
    body.retro #themeToggle:hover,
    body.retro .page-content button:hover {
      background: #003300 !important;
      color: #66ff66 !important;
    }
    body.retro .text-gray-500,
    body.retro .text-gray-600,
    body.retro .text-gray-700,
    body.retro .text-gray-800,
    body.retro p:not(.font-bold):not(h1):not(h2):not(h3) {
      color: #33ff33 !important;
      text-shadow: 0 0 2px #33ff33 !important;
    }
    body.retro .score-card {
      border: 3px solid #00ff00 !important;
      border-radius: 0 !important;
      box-shadow: 0 0 10px currentColor !important;
      background: #001a00 !important;
    }
    body.retro h1, body.retro h2, body.retro h3 {
      color: #00ff00 !important;
      text-shadow: 2px 2px 0 #003300, 0 0 10px #00ff00 !important;
    }
    body.retro p, body.retro div, body.retro span, body.retro label {
      color: #00ff00 !important;
    }
    body.retro .bg-gray-50, body.retro .bg-green-50, body.retro .bg-red-50 {
      background: #001a00 !important;
      border: 1px solid #003300 !important;
    }
    body.retro .bg-white { background: #000000 !important; }
    body.retro input {
      background: #000000 !important;
      border: 2px solid #00ff00 !important;
      color: #00ff00 !important;
    }
    body.retro input::placeholder { color: #006600 !important; }
    body.retro .menu-overlay {
      background: #000000 !important;
      border-right: 4px solid #00ff00 !important;
    }
    
    body.retro #pythiaLogo {
      width: 160px !important;
      height: 160px !important;
    }
    
    #mainTagline {
      font-size: 2rem !important;
    }
    body.retro #mainTagline {
      font-size: 2.5rem !important;
    }
    
    body.retro {
      background: 
        repeating-linear-gradient(0deg, #000000 0px, #003300 2px, #000000 4px),
        repeating-linear-gradient(90deg, #000000 0px, #001a00 2px, #000000 4px) !important;
    }
    
    body.retro .rivalry-item:nth-child(odd) {
      background: #003300 !important;
      border: 2px solid #00ff00 !important;
    }
    body.retro .rivalry-item:nth-child(even) {
      background: #001a00 !important;
      border: 2px solid #006600 !important;
    }
    
    .score-card {
      transition: all 0.3s;
      border: 2px solid transparent;
    }
    body:not(.retro) .score-card:hover {
      transform: scale(1.05);
      border-color: rgba(99, 102, 241, 0.3);
    }
    
    .sword-fighting { display: inline-block; animation: sword-swing 0.5s infinite; }
    @keyframes sword-swing {
      0%, 100% { transform: rotate(-15deg); }
      50% { transform: rotate(15deg); }
    }
    
    .tooltip { position: relative; display: inline-block; }
    .tooltip .tooltiptext {
      visibility: hidden; width: 280px; background-color: #1f2937; color: #fff;
      text-align: left; border-radius: 8px; padding: 12px; position: absolute; z-index: 1000;
      bottom: 125%; left: 50%; margin-left: -140px; opacity: 0; transition: opacity 0.3s;
      font-size: 13px; line-height: 1.4; box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .tooltip:hover .tooltiptext { visibility: visible; opacity: 1; }
    
    .leaderboard-entry { transition: all 0.2s; }
    .leaderboard-entry:hover {
      transform: translateX(4px);
      background: rgba(99, 102, 241, 0.1);
    }
    
    .cache-badge {
      display: inline-block; padding: 2px 8px; border-radius: 12px;
      font-size: 10px; font-weight: bold; margin-left: 8px;
    }
    .cache-live { background: #10b981; color: white; }
    .cache-stored { background: #6366f1; color: white; }
    
    .winner-icon {
      width: 80px; height: 80px; object-fit: contain; margin: 0 auto 1rem;
      border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
  </style>
</head>
<body class="retro bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 min-h-screen p-4 md:p-8">
  
  <!-- Boot Sequence -->
  <div id="bootSequence" class="boot-sequence hidden">
    <div class="boot-line">PYTHIA‚Ñ¢ SYSTEM v2.0</div>
    <div class="boot-line">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
    <div class="boot-line">Initializing Oracle Matrix...</div>
    <div class="boot-line">Loading Performance Analyzers...</div>
    <div class="boot-line">Calibrating P-Score Metrics...</div>
    <div class="boot-line">‚Ä¢ KARPOV Speed Engine [OK]</div>
    <div class="boot-line">‚Ä¢ VORTEX Accessibility Core [OK]</div>
    <div class="boot-line">‚Ä¢ PULSE SEO Module [OK]</div>
    <div class="boot-line">‚Ä¢ HELIX Privacy Shield [OK]</div>
    <div class="boot-line">‚Ä¢ NEXUS Mobile Adapter [OK]</div>
    <div class="boot-line">‚Ä¢ ECHO Sustainability Scanner [OK]</div>
    <div class="boot-line">‚Ä¢ NOVA Infrastructure Probe [OK]</div>
    <div class="boot-line">‚Ä¢ QUANTUM Code Analyzer [OK]</div>
    <div class="boot-line">‚Ä¢ AETHER Tech Detector [OK]</div>
    <div class="boot-line">‚Ä¢ EDEN Efficiency Monitor [OK]</div>
    <div class="boot-line">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
    <div class="boot-line">System Ready. Press any key...</div>
  </div>
  
  <!-- Sound Toggle -->
  <div class="sound-toggle" id="soundToggle" title="Toggle Sound Effects" aria-label="Toggle retro sounds">
    <span id="soundIcon">üîä</span>
  </div>
  
  <!-- Visit Counter -->
  <div class="visit-counter" id="visitCounter">
    Visitors: <span id="visitCount">Loading...</span>
  </div>
  
  <div id="menuBackdrop" class="menu-backdrop" onclick="closeMenu()"></div>
  
  <div id="menuOverlay" class="menu-overlay">
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-indigo-600">Pythia‚Ñ¢ Menu</h2>
        <button onclick="closeMenu()" class="text-3xl text-gray-600 hover:text-gray-800" aria-label="Close menu">&times;</button>
      </div>
      <nav class="space-y-2">
        <button onclick="showPage('main')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-indigo-50 font-bold text-gray-700">üè† Home</button>
        <button onclick="showPage('pscore-explainer')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-indigo-50 font-bold text-gray-700">üìä P-Score Explainer</button>
        <button onclick="showPage('components')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-indigo-50 font-bold text-gray-700">üîß P-Score Components</button>
        <button onclick="showPage('custom')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-indigo-50 font-bold text-indigo-600">üíé Custom Scans (Premium)</button>
        <button onclick="showPage('about')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-indigo-50 font-bold text-gray-700">‚ÑπÔ∏è About</button>
        <button onclick="showPage('legal')" class="w-full text-left px-4 py-3 rounded-lg hover:bg-blue-50 font-bold text-gray-700">‚öñÔ∏è Legal & Privacy</button>
      </nav>
    </div>
  </div>
  
  <div class="max-w-7xl mx-auto">
    
    <div id="mainPage" class="page-content active">
      
      <div class="text-center mb-6">
        <div class="flex justify-between items-center mb-2">
          <button id="hamburger" onclick="openMenu()" class="text-3xl text-gray-700 hover:text-indigo-600 transition" aria-label="Open menu">‚ò∞</button>
          <button id="themeToggle" class="px-4 py-2 bg-gray-200 rounded-lg text-sm font-bold hover:bg-gray-300 transition">üïπÔ∏è Boring Mode</button>
        </div>
        <div class="flex items-center justify-center gap-4 mb-2">
          <img id="pythiaLogo" src="pythia-oracle.png" alt="Pythia‚Ñ¢ Oracle" class="w-20 h-20" style="display:none; image-rendering: pixelated;">
          <h1 class="text-6xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Pythia‚Ñ¢</h1>
        </div>
        <p class="text-gray-600 text-lg">Complete website performance oracle <span class="text-sm bg-yellow-200 px-2 py-1 rounded">BETA</span></p>
        <h2 id="mainTagline" class="text-xl font-bold text-indigo-600 mt-2 tracking-wide">ONE SCORE TO RANK THEM ALL</h2>
        
        <!-- Delphi Text -->
        <div class="modern-card bg-white rounded-lg shadow-lg p-4 mt-4 max-w-2xl mx-auto">
          <p class="text-sm text-gray-700 italic leading-relaxed">
            At Delphi in ancient Greece, the Pythia spoke cryptic truths from the gods. 
            Now seek her oracle wisely ‚Äî your site awaits her verdict!
          </p>
        </div>
        
        <p class="text-xs text-gray-500 mt-2 max-w-2xl mx-auto"><strong>Disclaimer:</strong> Scores are automated estimates. <a href="mailto:dispute@p-score.me?subject=Pythia Dispute" class="underline">Contact us to dispute</a>.</p>
      </div>
      
      <div class="modern-card bg-white rounded-2xl shadow-xl p-6 mb-8">
        <div class="flex flex-col md:flex-row gap-4">
          <input id="urlInput" type="url" placeholder="example.com or https://example.com" class="flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-indigo-500 transition" aria-label="Enter website URL to analyze">
          <button id="scanBtn" class="retro-button px-8 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold rounded-xl hover:from-indigo-700 hover:to-purple-700 transition transform hover:scale-105" aria-label="Analyze website performance">ANALYZE</button>
          <button id="demoBtn" class="retro-button px-6 py-3 bg-purple-600 text-white font-bold rounded-xl hover:bg-purple-700 transition" aria-label="Try demo URL">TRY DEMO</button>
          <button id="consultBtn" class="retro-button px-6 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white font-bold rounded-xl hover:from-pink-600 hover:to-purple-700 transition" aria-label="Consult Pythia">üîÆ CONSULT</button>
          <button id="exportBtn" class="retro-button px-6 py-3 bg-gray-600 text-white font-bold rounded-xl hover:bg-gray-700 transition" style="display:none;" aria-label="Export analysis results">üìä EXPORT</button>
        </div>
      </div>
      
      <!-- Loading Spinner -->
      <div id="loadingSpinner" class="hidden text-center my-8">
        <div class="retro-spinner"></div>
        <p class="text-gray-600 mt-4 font-bold">Consulting the Oracle...</p>
      </div>
      
      <!-- Consultation Results -->
      <div id="consultationResults" class="modern-card bg-gradient-to-br from-purple-900 to-indigo-900 rounded-lg shadow-lg p-6 mb-6 hidden">
        <h3 class="text-2xl font-bold text-center mb-4" style="color: #00ff00;">üîÆ The Oracle Speaks üîÆ</h3>
        <div id="consultationText" class="text-lg text-center italic" style="color: #66ff66; text-shadow: 0 0 10px #00ff00;"></div>
      </div>
      
      <div id="pscoreContainer" class="hidden mb-8">
        <div class="modern-card bg-gradient-to-br from-indigo-600 to-purple-700 rounded-2xl shadow-2xl p-8 text-center text-white">
          <div class="text-sm font-bold uppercase tracking-wider opacity-90 mb-2">Overall P-Score‚Ñ¢</div>
          <div id="pscoreValue" class="text-7xl font-bold mb-2 typing-effect" aria-live="polite">--</div>
          <div class="text-lg opacity-90">Performance ‚Ä¢ Sustainability ‚Ä¢ Future-Ready</div>
          <div id="siteInfo" class="text-sm opacity-75 mt-3"></div>
          <div class="text-xs mt-2 opacity-75">Scanned by Pythia‚Ñ¢ üîÆ</div>
        </div>
      </div>
      
      <div id="resultsContainer" class="hidden grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8" role="region" aria-label="Website performance metrics"></div>
      
      <!-- Toggle Details Button -->
      <div id="toggleDetailsSection" class="hidden text-center mb-4">
        <button id="toggleDetailsBtn" class="retro-button px-6 py-3 bg-gray-600 text-white font-bold rounded-lg hover:bg-gray-700 transition">
          ‚ñº Show Detailed Breakdown
        </button>
      </div>
      
      <!-- Detailed Breakdown (Collapsible) -->
      <div id="detailsBreakdown" class="detail-content collapsed hidden mb-8"></div>
      
      <!-- Badge Section -->
      <div id="badgeSection" class="modern-card bg-white rounded-lg shadow-lg p-6 mb-8 hidden">
        <h3 class="text-xl font-bold mb-4">üèÖ Generate P-Score‚Ñ¢ Badge</h3>
        <div class="mb-4">
          <label class="block text-sm font-bold mb-2" for="badgeCompare">Compare with Top 50 site:</label>
          <select id="badgeCompare" class="w-full p-2 border border-gray-300 rounded-lg">
            <option value="">Select a site...</option>
          </select>
        </div>
        <button onclick="generateBadge()" class="retro-button w-full bg-purple-600 text-white py-2 rounded-lg font-bold hover:bg-purple-700 transition">
          Generate Badge
        </button>
        
        <div id="badgePreview" class="mt-6 hidden">
          <div id="badgeCard" class="badge-card">
            <div class="text-sm opacity-80 mb-2">Scanned by Pythia‚Ñ¢ üîÆ</div>
            <div class="badge-pscore" id="badgePscore">--</div>
            <div class="text-xl font-bold mb-2">P-Score‚Ñ¢</div>
            <div id="badgeComparison" class="text-lg mb-4">--</div>
            <div class="text-xs opacity-75" id="badgeUrl">--</div>
            <div class="text-xs mt-4">
              === ORACLE REPORT ===
            </div>
          </div>
          <button onclick="downloadBadgePNG()" class="retro-button w-full bg-green-600 text-white py-2 rounded-lg font-bold hover:bg-green-700 transition mt-4">
            Download PNG
          </button>
        </div>
      </div>
      
      <!-- Leaderboard Section (Deleted per instructions - no #leaderboard div or JS calls) -->
      <!-- Removed entirely -->
      
      <!-- Rivalry Battles -->
      <div class="modern-card bg-white rounded-2xl shadow-xl p-6 mb-8">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-red-500 to-purple-500 bg-clip-text text-transparent">‚öîÔ∏è RIVALRY BATTLES</h3>
        <div class="grid md:grid-cols-2 gap-4 mb-6">
          <div class="p-4 rounded-lg border border-gray-200">
            <h4 class="text-lg font-bold mb-3">Custom Battle</h4>
            <input id="customUrl1" type="url" placeholder="URL 1 (e.g. https://example1.com)" class="w-full px-4 py-3 border border-gray-200 rounded-xl mb-2 focus:outline-none focus:border-indigo-500 transition" aria-label="Enter first URL for custom battle">
            <input id="customUrl2" type="url" placeholder="URL 2 (e.g. https://example2.com)" class="w-full px-4 py-3 border border-gray-200 rounded-xl mb-4 focus:outline-none focus:border-indigo-500 transition" aria-label="Enter second URL for custom battle">
            <button id="customBattleBtn" class="retro-button w-full px-6 py-3 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition">‚öîÔ∏è START BATTLE</button>
          </div>
          <div class="p-4 rounded-lg border border-gray-200">
            <h4 class="text-lg font-bold mb-3">Pre-Set Rivalries</h4>
            <div id="rivalryList" class="space-y-2 max-h-40 overflow-y-auto"></div>
          </div>
        </div>
        <div id="battleResults" class="hidden">
          <div class="modern-card bg-gradient-to-br from-red-900 to-purple-900 rounded-lg shadow-lg p-6 mb-6">
            <div class="grid md:grid-cols-3 gap-4">
              <div id="contestant1Results" class="text-white"></div>
              <div class="text-center">
                <div id="winnerIcon" class="hidden mb-4">
                  <img src="" alt="Winner logo" class="winner-icon">
                </div>
                <div id="winnerAnnouncement" class="text-2xl font-bold text-yellow-300 mb-2"></div>
              </div>
              <div id="contestant2Results" class="text-white"></div>
            </div>
          </div>
          <button id="shareRivalryBtn" class="retro-button w-full px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition">üì§ Share Battle</button>
        </div>
      </div>
      
      <!-- Top 50 Leaderboard -->
      <div class="modern-card bg-white rounded-2xl shadow-xl p-6 mb-8">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-green-500 to-indigo-500 bg-clip-text text-transparent">üèÜ TOP 50 LEADERBOARD</h3>
        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <h4 class="text-lg font-bold mb-3 text-green-600">Top 5 Sites</h4>
            <div id="top50TopList" class="space-y-2"></div>
          </div>
          <div>
            <h4 class="text-lg font-bold mb-3 text-red-600">Bottom 5 Sites</h4>
            <div id="top50BottomList" class="space-y-2"></div>
          </div>
        </div>
        <div id="top50Loading" class="text-center my-4 text-gray-600">Loading rankings...</div>
        <div id="top50Results" class="hidden"></div>
      </div>
      
      <!-- Enterprise Daily Winner -->
      <div class="modern-card bg-white rounded-2xl shadow-xl p-6 mb-8">
        <h3 class="text-2xl font-bold mb-6 text-center bg-gradient-to-r from-purple-500 to-pink-500 bg-clip-text text-transparent">üè¢ ENTERPRISE DAILY WINNER</h3>
        <div id="enterpriseDailyResults" class="hidden text-center">
          <h4 class="text-xl font-bold text-purple-600 mb-2"><a id="enterpriseLink" href="#" target="_blank" rel="noopener noreferrer"><span id="enterpriseWinner"></span></a></h4>
          <p class="text-lg">P-Score‚Ñ¢: <span id="enterprisePscore"></span></p>
          <p class="text-sm text-gray-600">Load Time: <span id="enterpriseLoadTime"></span>ms</p>
          <p class="text-xs text-gray-500 mt-2" id="enterpriseTotalScanned"></p>
        </div>
        <div id="enterpriseDailyLoading" class="text-center my-4 text-gray-600">Loading enterprise winner...</div>
      </div>
      
    </div>
    
    <!-- P-Score Explainer Page -->
    <div id="pscore-explainerPage" class="page-content">
      <div class="page-header">
        <button onclick="showPage('main')" class="text-2xl text-gray-600 hover:text-indigo-600" aria-label="Back to home">‚Üê</button>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">P-Score‚Ñ¢ Explainer</h2>
      </div>
      <div class="space-y-4 text-gray-700">
        <p>The P-Score‚Ñ¢ is a unified metric (0-100) that ranks website performance holistically. It aggregates 10 key components, each weighted 10%.</p>
        <p>It compares favorably to Google PageSpeed Insights (which focuses mainly on speed) by including sustainability, privacy, and future-readiness. Unlike Lighthouse, it uses custom heuristics (pinned to v13 logic for compliance) without API calls.</p>
        <ul class="list-disc pl-6">
          <li><strong>Karpov (Speed)</strong>: Load time, resource optimization.</li>
          <li><strong>Vortex (Accessibility)</strong>: ARIA, alt tags, headings.</li>
          <li><strong>Pulse (SEO)</strong>: Meta tags, OG, canonical.</li>
          <li><strong>Helix (Privacy)</strong>: Trackers, security headers.</li>
          <li><strong>Nexus (Mobile)</strong>: Viewport, media queries.</li>
          <li><strong>Echo (Sustainability)</strong>: Page weight, green hosting.</li>
          <li><strong>Nova (Infrastructure)</strong>: CDN, caching, compression.</li>
          <li><strong>Quantum (Code Quality)</strong>: Best practices, no eval.</li>
          <li><strong>Aether (Tech)</strong>: WebAssembly, modules, frameworks.</li>
          <li><strong>Eden (Efficiency)</strong>: Size optimization.</li>
        </ul>
        <p>Scores are estimates; dispute via email.</p>
      </div>
    </div>
    
    <!-- Components Page -->
    <div id="componentsPage" class="page-content">
      <div class="page-header">
        <button onclick="showPage('main')" class="text-2xl text-gray-600 hover:text-indigo-600" aria-label="Back to home">‚Üê</button>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">P-Score‚Ñ¢ Components</h2>
      </div>
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
        <!-- Component cards for each metric, e.g. -->
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Karpov: Speed</h3>
          <p class="text-gray-600">Measures load time, resource count, async/defer/minification.</p>
        </div>
        <!-- Repeat for all 10 components -->
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Vortex: Accessibility</h3>
          <p class="text-gray-600">Alt tags, ARIA, headings, labels (WCAG compliant).</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Pulse: SEO</h3>
          <p class="text-gray-600">Title, meta description, OG tags, canonical.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Helix: Privacy</h3>
          <p class="text-gray-600">Trackers, third-party scripts, security headers.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Nexus: Mobile</h3>
          <p class="text-gray-600">Viewport, media queries, PWA elements.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Echo: Sustainability</h3>
          <p class="text-gray-600">Page weight, format optimization, green hosting check.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Nova: Infrastructure</h3>
          <p class="text-gray-600">CDN, caching, compression.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Quantum: Code Quality</h3>
          <p class="text-gray-600">No deprecated practices, integrity, crossorigin.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Aether: Tech</h3>
          <p class="text-gray-600">Modern features like WebAssembly, modules, frameworks.</p>
        </div>
        <div class="score-card modern-card bg-white rounded-lg shadow-lg p-4">
          <h3 class="text-xl font-bold mb-2">Eden: Efficiency</h3>
          <p class="text-gray-600">Overall page size and resource efficiency.</p>
        </div>
      </div>
    </div>
    
    <!-- Custom Scans Page (Placeholder) -->
    <div id="customPage" class="page-content">
      <div class="page-header">
        <button onclick="showPage('main')" class="text-2xl text-gray-600 hover:text-indigo-600" aria-label="Back to home">‚Üê</button>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Custom Scans (Premium)</h2>
      </div>
      <p class="text-gray-700">Coming soon: Customize metrics, schedule scans, API access.</p>
    </div>
    
    <!-- About Page -->
    <div id="aboutPage" class="page-content">
      <div class="page-header">
        <button onclick="showPage('main')" class="text-2xl text-gray-600 hover:text-indigo-600" aria-label="Back to home">‚Üê</button>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">About Pythia‚Ñ¢</h2>
      </div>
      <p class="text-gray-700">Pythia‚Ñ¢ is a free tool by Cronix to analyze website performance. Inspired by the ancient oracle, it provides a single P-Score‚Ñ¢ for benchmarking.</p>
      <p>Made with love in South Africa. ¬© 2025 Cronix Holdings (Pty) Ltd.</p>
    </div>
    
    <!-- Legal Page -->
    <div id="legalPage" class="page-content">
      <div class="page-header">
        <button onclick="showPage('main')" class="text-2xl text-gray-600 hover:text-indigo-600" aria-label="Back to home">‚Üê</button>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">Legal & Privacy</h2>
      </div>
      <p class="text-gray-700">Pythia‚Ñ¢ uses public APIs with attribution. Scores are algorithmic estimates, not endorsements. See <a href="/tos" class="underline">ToS</a> | <a href="/privacy" class="underline">Privacy</a>.</p>
      <p>No PII stored. Opt-out via robots.txt. Data deletion: email dispute@p-score.me.</p>
      <p>Accessibility: Compliant with WCAG 2.1 AA, validated by WAVE.</p>
    </div>
    
  </div>
  
  <footer class="text-center text-gray-600 text-sm mt-12">
    <p class="mb-2">üîÆ Pythia‚Ñ¢ ‚Äî Website Performance Oracle</p>
    <p class="mt-1">Analysis time varies 5-15 seconds ‚Ä¢ Scores cached 5min for stability</p>
    <p class="text-xs mt-2 opacity-75">Pythia uses public APIs with attribution. Scores are algorithmic estimates, not endorsements. See <a href="/tos" class="underline">ToS</a> | <a href="/privacy" class="underline">Privacy</a>.</p>
    <p class="text-xs mt-1 opacity-75"><strong>Disclaimer:</strong> Scores are automated estimates. <a href="mailto:dispute@p-score.me?subject=Pythia Dispute" class="underline">Contact us to dispute</a>.</p>
    <div class="mt-6 flex justify-center gap-3 flex-wrap">
      <button onclick="shareOn('twitter')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">X</button>
      <button onclick="shareOn('facebook')" class="px-4 py-2 bg-blue-800 text-white rounded hover:bg-blue-900">Facebook</button>
      <button onclick="shareOn('whatsapp')" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">WhatsApp</button>
      <button onclick="shareOn('email')" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">Email</button>
    </div>
    <p class="text-gray-600 mt-6 mb-2" style="font-family: 'Courier New', monospace; font-weight: bold;">
      Made by Cronix
    </p>
    <p class="text-gray-400 text-xs">
      ¬© 2025 Cronix Holdings (Pty) Ltd, South Africa
    </p>
    <p id="retroQuote" class="mt-4 text-xs italic text-gray-400" style="display:none;">"I am in doubt whether to pronounce you man or god,<br>but I think rather you are a god, Lycurgus."</p>
  </footer>
  
  <script>
    // Concise, modular code with comments. Full restored from docx + updates.
    // Global vars
    const TOP50_API = '/api/top50';
    const ENTERPRISE_API = '/api/enterprise-daily';
    const VISIT_API = '/api/visits';
    const CACHE_TTL = 5 * 60 * 1000; // 5min
    let currentData = null;
    let currentBattleData = null;
    let audioCtx = null;
    let leaderboard = [];
    const RIVALRIES = [
      { category: 'Academic', name1: 'Oxford', url1: 'https://www.ox.ac.uk', name2: 'Cambridge', url2: 'https://www.cam.ac.uk', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Oxford-University-Circlet.svg/120px-Oxford-University-Circlet.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/University_of_Cambridge_coat_of_arms_official.svg/120px-University_of_Cambridge_coat_of_arms_official.svg.png' },
      { category: 'Academic', name1: 'Harvard', url1: 'https://www.harvard.edu', name2: 'Yale', url2: 'https://www.yale.edu', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/71/Harvard_Shield.png/120px-Harvard_Shield.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Yale_University_Shield_1.svg/120px-Yale_University_Shield_1.svg.png' },
      { category: 'Academic', name1: 'MIT', url1: 'https://www.mit.edu', name2: 'Caltech', url2: 'https://www.caltech.edu', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0c/MIT_logo.svg/120px-MIT_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Caltech_seal.svg/120px-Caltech_seal.svg.png' },
      { category: 'Nations', name1: 'India', url1: 'https://www.india.gov.in', name2: 'Pakistan', url2: 'https://www.pakistan.gov.pk', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/Flag_of_India.svg/120px-Flag_of_India.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/32/Flag_of_Pakistan.svg/120px-Flag_of_Pakistan.svg.png' },
      { category: 'Sports', name1: 'Springboks', url1: 'https://www.springboks.rugby', name2: 'All Blacks', url2: 'https://www.allblacks.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Springbok_emblem.svg/120px-Springbok_emblem.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/All_Blacks_logo.svg/120px-All_Blacks_logo.svg.png' },
      { category: 'Sports', name1: 'ManU', url1: 'https://www.manutd.com', name2: 'Liverpool', url2: 'https://www.liverpoolfc.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/7/7a/Manchester_United_FC_crest.svg/120px-Manchester_United_FC_crest.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/0/0c/Liverpool_FC.svg/120px-Liverpool_FC.svg.png' },
      { category: 'Sports', name1: 'Arsenal', url1: 'https://www.arsenal.com', name2: 'Chelsea', url2: 'https://www.chelseafc.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/5/53/Arsenal_FC.svg/120px-Arsenal_FC.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/c/cc/Chelsea_FC.svg/120px-Chelsea_FC.svg.png' },
      { category: 'Sports', name1: 'Real Madrid', url1: 'https://www.realmadrid.com', name2: 'Barcelona', url2: 'https://www.fcbarcelona.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/5/56/Real_Madrid_CF.svg/120px-Real_Madrid_CF.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/4/47/FC_Barcelona_%28crest%29.svg/120px-FC_Barcelona_%28crest%29.svg.png' },
      { category: 'Sports', name1: 'LA Lakers', url1: 'https://www.nba.com/lakers', name2: 'Boston Celtics', url2: 'https://www.nba.com/celtics', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Los_Angeles_Lakers_logo.svg/120px-Los_Angeles_Lakers_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/8/8f/Boston_Celtics.svg/120px-Boston_Celtics.svg.png' },
      { category: 'Sports', name1: 'Army', url1: 'https://www.army.mil', name2: 'Navy', url2: 'https://www.navy.mil', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/19/Emblem_of_the_United_States_Department_of_the_Army.svg/120px-Emblem_of_the_United_States_Department_of_the_Army.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Emblem_of_the_United_States_Navy.svg/120px-Emblem_of_the_United_States_Navy.svg.png' },
      { category: 'Sports', name1: 'NY Yankees', url1: 'https://www.mlb.com/yankees', name2: 'Red Sox', url2: 'https://www.mlb.com/redsox', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/New_York_Yankees_logo.svg/120px-New_York_Yankees_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/6/6d/RedSoxPrimary_HangingSocks.svg/120px-RedSoxPrimary_HangingSocks.svg.png' },
      { category: 'Retail', name1: 'Amazon', url1: 'https://www.amazon.com', name2: 'Walmart', url2: 'https://www.walmart.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Amazon_logo.svg/120px-Amazon_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Walmart_logo.svg/120px-Walmart_logo.svg.png' },
      { category: 'Retail', name1: 'Craigslist', url1: 'https://www.craigslist.org', name2: 'FB Marketplace', url2: 'https://www.facebook.com/marketplace', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/Craigslist-logo.png/120px-Craigslist-logo.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0a/Facebook_Marketplace_Logo.png/120px-Facebook_Marketplace_Logo.png' },
      { category: 'Food', name1: 'McD', url1: 'https://www.mcdonalds.com', name2: 'BK', url2: 'https://www.bk.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/McDonald%27s_Golden_Arches.svg/120px-McDonald%27s_Golden_Arches.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Burger_King_Logo.svg/120px-Burger_King_Logo.svg.png' },
      { category: 'Food', name1: 'Starbucks', url1: 'https://www.starbucks.com', name2: 'Costa', url2: 'https://www.costacoffee.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/d/d3/Starbucks_Corporation_Logo_2011.svg/120px-Starbucks_Corporation_Logo_2011.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/5/5b/Costa_Coffee_logo.svg/120px-Costa_Coffee_logo.svg.png' },
      { category: 'Luxury', name1: 'LV', url1: 'https://www.louisvuitton.com', name2: 'Gucci', url2: 'https://www.gucci.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0f/Louis_Vuitton_logo_and_wordmark.svg/120px-Louis_Vuitton_logo_and_wordmark.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Gucci_logo.svg/120px-Gucci_logo.svg.png' },
      { category: 'Tech', name1: 'Apple', url1: 'https://www.apple.com', name2: 'Samsung', url2: 'https://www.samsung.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/Apple_logo_black.svg/120px-Apple_logo_black.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Samsung_Logo.svg/120px-Samsung_Logo.svg.png' },
      { category: 'EV', name1: 'Tesla', url1: 'https://www.tesla.com', name2: 'BYD', url2: 'https://www.byd.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bd/Tesla_Motors.svg/120px-Tesla_Motors.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/BYD_logo.svg/120px-BYD_logo.svg.png' },
      { category: 'Space', name1: 'SpaceX', url1: 'https://www.spacex.com', name2: 'Blue Origin', url2: 'https://www.blueorigin.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/SpaceX_Logo_Black.png/120px-SpaceX_Logo_Black.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/Blue_Origin_logo.svg/120px-Blue_Origin_logo.svg.png' },
      { category: 'Cities', name1: 'London', url1: 'https://www.london.gov.uk', name2: 'Paris', url2: 'https://www.paris.fr', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/GLA_Logo.svg/120px-GLA_Logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/Coat_of_arms_of_Paris.svg/120px-Coat_of_arms_of_Paris.svg.png' },
      { category: 'Cities', name1: 'NY', url1: 'https://www.nyc.gov', name2: 'Tokyo', url2: 'https://www.metro.tokyo.lg.jp', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Seal_of_New_York_City_BW.svg/120px-Seal_of_New_York_City_BW.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/Tokyo_Metropolitan_Government_logo.svg/120px-Tokyo_Metropolitan_Government_logo.svg.png' },
      { category: 'Cities', name1: 'Cape Town', url1: 'https://www.capetown.gov.za', name2: 'Rio', url2: 'https://www.rio.rj.gov.br', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Coat_of_arms_of_Cape_Town.svg/120px-Coat_of_arms_of_Cape_Town.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/Bras%C3%A3o_da_cidade_do_Rio_de_Janeiro.svg/120px-Bras%C3%A3o_da_cidade_do_Rio_de_Janeiro.svg.png' },
      { category: 'Government', name1: 'White House', url1: 'https://www.whitehouse.gov', name2: 'No10', url2: 'https://www.gov.uk/government/organisations/prime-ministers-office-10-downing-street', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2e/Seal_of_the_President_of_the_United_States.svg/120px-Seal_of_the_President_of_the_United_States.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Royal_Arms_of_the_United_Kingdom_%28Crown_%26_Garter%29.svg/120px-Royal_Arms_of_the_United_Kingdom_%28Crown_%26_Garter%29.svg.png' },
      { category: 'Government', name1: 'UN', url1: 'https://www.un.org', name2: 'EU', url2: 'https://europa.eu', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Flag_of_the_United_Nations.svg/120px-Flag_of_the_United_Nations.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b7/Flag_of_Europe.svg/120px-Flag_of_Europe.svg.png' },
      { category: 'Finance', name1: 'World Bank', url1: 'https://www.worldbank.org', name2: 'IMF', url2: 'https://www.imf.org', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/64/World_Bank_logo.svg/120px-World_Bank_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/International_Monetary_Fund_logo.svg/120px-International_Monetary_Fund_logo.svg.png' },
      { category: 'Finance', name1: 'G7', url1: 'https://www.g7italy.it', name2: 'G20', url2: 'https://www.g20.org', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/G7_Logo_2024.svg/120px-G7_Logo_2024.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/G20_Logo_2023.png/120px-G20_Logo_2023.png' },
      { category: 'Tech Giants', name1: 'Google', url1: 'https://www.google.com', name2: 'Meta', url2: 'https://www.meta.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/120px-Google_2015_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/51/Facebook_f_logo_%282019%29.svg/120px-Facebook_f_logo_%282019%29.svg.png' },
      { category: 'AI', name1: 'DeepMind', url1: 'https://www.deepmind.com', name2: 'OpenAI', url2: 'https://www.openai.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/89/DeepMind_logo.svg/120px-DeepMind_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/OpenAI_Logo.svg/120px-OpenAI_Logo.svg.png' },
      { category: 'AI', name1: 'Anthropic', url1: 'https://www.anthropic.com', name2: 'xAI', url2: 'https://x.ai', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Anthropic_Logo.svg/120px-Anthropic_Logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/8e/XAI_logo.svg/120px-XAI_logo.svg.png' },
      { category: 'F1', name1: 'McLaren', url1: 'https://www.mclaren.com', name2: 'Red Bull', url2: 'https://www.redbullracing.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/41/McLaren_Group_2015_logo.svg/120px-McLaren_Group_2015_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/48/Oracle_Red_Bull_Racing_logo.svg/120px-Oracle_Red_Bull_Racing_logo.svg.png' },
      { category: 'Cars', name1: 'Ferrari', url1: 'https://www.ferrari.com', name2: 'Porsche', url2: 'https://www.porsche.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/d/d5/Ferrari_Prancing_Horse.svg/120px-Ferrari_Prancing_Horse.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Porsche_logo.svg/120px-Porsche_logo.svg.png' },
      { category: 'Socials', name1: 'X', url1: 'https://www.x.com', name2: 'Threads', url2: 'https://www.threads.net', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/57/X_logo_2023_%28white%29.png/120px-X_logo_2023_%28white%29.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Threads_%28app%29_logo.svg/120px-Threads_%28app%29_logo.svg.png' },
      { category: 'Socials', name1: 'TikTok', url1: 'https://www.tiktok.com', name2: 'YouTube', url2: 'https://www.youtube.com', logo1: 'https://upload.wikimedia.org/wikipedia/en/thumb/a/a9/TikTok_logo.svg/120px-TikTok_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/YouTube_full-color_icon_%282017%29.svg/120px-YouTube_full-color_icon_%282017%29.svg.png' },
      { category: 'Socials', name1: 'LinkedIn', url1: 'https://www.linkedin.com', name2: 'BlueSky', url2: 'https://bsky.app', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/LinkedIn_logo_initials.png/120px-LinkedIn_logo_initials.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/Bluesky_Logo.svg/120px-Bluesky_Logo.svg.png' },
      { category: 'Messaging', name1: 'WhatsApp', url1: 'https://www.whatsapp.com', name2: 'Telegram', url2: 'https://www.telegram.org', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/6/6b/WhatsApp.svg/120px-WhatsApp.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/83/Telegram_2019_Logo.svg/120px-Telegram_2019_Logo.svg.png' },
      { category: 'Entertainment', name1: 'Marvel', url1: 'https://www.marvel.com', name2: 'DC', url2: 'https://www.dc.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/MarvelLogo.svg/120px-MarvelLogo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/DC_Comics_logo.svg/120px-DC_Comics_logo.svg.png' },
      { category: 'Streaming', name1: 'Netflix', url1: 'https://www.netflix.com', name2: 'Disney+', url2: 'https://www.disneyplus.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/08/Netflix_2015_logo.svg/120px-Netflix_2015_logo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Disney%2B_logo.svg/120px-Disney%2B_logo.svg.png' },
      { category: 'Gaming', name1: 'Nintendo', url1: 'https://www.nintendo.com', name2: 'PlayStation', url2: 'https://www.playstation.com', logo1: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Nintendo.svg/120px-Nintendo.svg.png', logo2: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/PlayStation_logo.svg/120px-PlayStation_logo.svg.png' }
    ];

    // Modular functions
    function toggleTheme() {
      document.body.classList.toggle('retro');
      const btn = document.getElementById('themeToggle');
      btn.textContent = document.body.classList.contains('retro') ? 'üïπÔ∏è Boring Mode' : 'üïπÔ∏è Retro Mode';
      playSound('click');
    }

    function openMenu() {
      document.getElementById('menuOverlay').classList.add('open');
      document.getElementById('menuBackdrop').classList.add('open');
      playSound('click');
    }

    function closeMenu() {
      document.getElementById('menuOverlay').classList.remove('open');
      document.getElementById('menuBackdrop').classList.remove('open');
      playSound('click');
    }

    function showPage(pageId) {
      document.querySelectorAll('.page-content').forEach(page => page.classList.remove('active'));
      document.getElementById(pageId + 'Page').classList.add('active');
      closeMenu();
      playSound('click');
    }

    function getCachedScan(url) {
      const cached = localStorage.getItem(url);
      if (cached) {
        const data = JSON.parse(cached);
        if (Date.now() - data.timestamp < CACHE_TTL) return data;
      }
      return null;
    }

    function setCachedScan(url, data) {
      data.timestamp = Date.now();
      localStorage.setItem(url, JSON.stringify(data));
    }

    async function analyzeSite() {
      const input = document.getElementById('urlInput');
      const url = normalizeUrl(input.value.trim());
      if (!url) {
        alert('Please enter a valid URL');
        return;
      }
      
      const cached = getCachedScan(url);
      if (cached) {
        currentData = cached;
        displayResults(cached, true);
        return;
      }
      
      playSound('beep');
      const scanBtn = document.getElementById('scanBtn');
      scanBtn.textContent = 'ANALYZING...';
      scanBtn.disabled = true;
      document.getElementById('loadingSpinner').classList.remove('hidden');
      document.getElementById('pscoreContainer').classList.add('hidden');
      document.getElementById('resultsContainer').classList.add('hidden');
      document.getElementById('badgeSection').classList.add('hidden');
      document.getElementById('toggleDetailsSection').classList.add('hidden');
      document.getElementById('detailsBreakdown').classList.add('hidden');
      
      try {
        const response = await fetch('/api/scan', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ url })
        });
        if (!response.ok) throw new Error('Scan failed');
        const data = await response.json();
        if (data.error) throw new Error(data.message);
        
        setCachedScan(url, data);
        currentData = data;
        displayResults(data, false);
      } catch (error) {
        alert('Analysis failed: ' + error.message);
      } finally {
        scanBtn.textContent = 'ANALYZE';
        scanBtn.disabled = false;
        document.getElementById('loadingSpinner').classList.add('hidden');
      }
    }

    function displayResults(data, fromCache) {
      // P-Score display with typing
      const pscoreValue = document.getElementById('pscoreValue');
      pscoreValue.classList.add('typing-effect');
      typeWriter(pscoreValue, `P-Score: ${data.pscore}`);
      document.getElementById('siteInfo').textContent = `for ${new URL(data.url).hostname} (${data.pageSize}, ${data.loadTime})`;
      
      // Results grid
      const resultsContainer = document.getElementById('resultsContainer');
      resultsContainer.innerHTML = '';
      const metrics = [
        { name: 'Karpov', key: 'karpov', color: 'blue', desc: 'Speed & Performance' },
        { name: 'Vortex', key: 'vortex', color: 'green', desc: 'Accessibility' },
        { name: 'Pulse', key: 'pulse', color: 'yellow', desc: 'SEO & Social' },
        { name: 'Helix', key: 'helix', color: 'purple', desc: 'Privacy & Security' },
        { name: 'Nexus', key: 'nexus', color: 'pink', desc: 'Mobile Responsiveness' },
        { name: 'Echo', key: 'echo', color: 'teal', desc: 'Sustainability' },
        { name: 'Nova', key: 'nova', color: 'indigo', desc: 'Infrastructure' },
        { name: 'Quantum', key: 'quantum', color: 'red', desc: 'Code Quality' },
        { name: 'Aether', key: 'aether', color: 'orange', desc: 'Modern Tech' },
        { name: 'Eden', key: 'eden', color: 'lime', desc: 'Efficiency' }
      ];
      metrics.forEach(metric => {
        const score = data[metric.key];
        const card = document.createElement('div');
        card.className = `score-card modern-card bg-${metric.color}-50 rounded-lg shadow-lg p-4 text-center`;
        card.innerHTML = `
          <h3 class="text-xl font-bold mb-2 text-${metric.color}-600">${metric.name}</h3>
          <div class="text-3xl font-bold text-${metric.color}-800">${score}</div>
          <p class="text-sm text-gray-600 mt-2">${metric.desc}</p>
        `;
        resultsContainer.appendChild(card);
      });
      
      // Details breakdown
      const details = document.getElementById('detailsBreakdown');
      details.innerHTML = ''; // Populate with data.breakdown (e.g., lists/tables for each metric)
      Object.keys(data.breakdown).forEach(key => {
        const section = document.createElement('div');
        section.innerHTML = `<h4>${key.toUpperCase()} Details</h4><pre>${JSON.stringify(data.breakdown[key], null, 2)}</pre>`;
        details.appendChild(section);
      });
      
      document.getElementById('pscoreContainer').classList.remove('hidden');
      document.getElementById('resultsContainer').classList.remove('hidden');
      document.getElementById('badgeSection').classList.remove('hidden');
      document.getElementById('toggleDetailsSection').classList.remove('hidden');
      document.getElementById('exportBtn').style.display = 'block';
      
      populateBadgeDropdown();
      // Removed saveToLeaderboard and updateLeaderboardDisplay calls (deleted feature)
    }

    function populateBadgeDropdown() {
      const select = document.getElementById('badgeCompare');
      select.innerHTML = '<option value="">Select a site...</option>';
      // Fetch top50 and add top 5 to dropdown
      fetch(TOP50_API).then(r => r.json()).then(data => {
        data.results.sort((a, b) => b.pscore - a.pscore).slice(0, 5).forEach(site => {
          const option = document.createElement('option');
          option.value = site.url;
          option.textContent = new URL(site.url).hostname + ' (P-Score: ' + site.pscore + ')';
          select.appendChild(option);
        });
      });
    }

    function generateBadge() {
      const compareUrl = document.getElementById('badgeCompare').value;
      const badgeCard = document.getElementById('badgeCard');
      const badgePscore = document.getElementById('badgePscore');
      const badgeComparison = document.getElementById('badgeComparison');
      const badgeUrl = document.getElementById('badgeUrl');
      
      badgePscore.textContent = currentData.pscore;
      badgeUrl.textContent = new URL(currentData.url).hostname;
      
      if (compareUrl) {
        fetch('/api/scan', { method: 'POST', body: JSON.stringify({ url: compareUrl }) }).then(r => r.json()).then(compareData => {
          const comparison = currentData.pscore > compareData.pscore ? 'Better than ' : 'Worse than ';
          badgeComparison.textContent = comparison + new URL(compareUrl).hostname + ' (' + compareData.pscore + ')';
        });
      } else {
        badgeComparison.textContent = '';
      }
      
      document.getElementById('badgePreview').classList.remove('hidden');
      playSound('beep');
    }

    function downloadBadgePNG() {
      const canvas = document.createElement('canvas');
      canvas.width = 400;
      canvas.height = 300;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = 'black';
      ctx.fillRect(0, 0, 400, 300);
      ctx.fillStyle = '#00ff00';
      ctx.font = 'bold 48px Courier';
      ctx.fillText('P-Score: ' + currentData.pscore, 50, 150);
      ctx.fillText('Scanned by Pythia‚Ñ¢ üîÆ', 50, 250);
      ctx.fillText('=== ORACLE REPORT ===', 20, 280);
      const link = document.createElement('a');
      link.download = 'pythia-badge.png';
      link.href = canvas.toDataURL();
      link.click();
      playSound('click');
    }

    function normalizeUrl(input) {
      let url = input.trim();
      if (!url.startsWith('http://') && !url.startsWith('https://')) url = 'https://' + url;
      return url;
    }

    function typeWriter(element, text, speed = 50) {
      element.innerHTML = '';
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          element.innerHTML += text.charAt(i);
          i++;
        } else {
          clearInterval(interval);
        }
      }, speed);
    }

    function showBootSequence() {
      const boot = document.getElementById('bootSequence');
      boot.classList.remove('hidden');
      let delay = 0;
      boot.querySelectorAll('.boot-line').forEach(line => {
        setTimeout(() => line.style.opacity = '1', delay);
        delay += 200;
      });
      setTimeout(() => boot.classList.add('hidden'), delay + 1000);
    }

    function initAudio() {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }

    function playSound(type) {
      if (!audioCtx) initAudio();
      if (document.getElementById('soundIcon').textContent === 'üîá') return;
      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);
      if (type === 'click') {
        oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
      } else if (type === 'beep') {
        oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
        gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
      }
      oscillator.start();
      oscillator.stop(audioCtx.currentTime + 0.3);
    }

    // Event listeners
    document.getElementById('themeToggle').addEventListener('click', toggleTheme);
    document.getElementById('scanBtn').addEventListener('click', analyzeSite);
    document.getElementById('urlInput').addEventListener('keypress', e => {
      if (e.key === 'Enter') analyzeSite();
    });
    document.getElementById('soundToggle').addEventListener('click', () => {
      const icon = document.getElementById('soundIcon');
      icon.textContent = icon.textContent === 'üîä' ? 'üîá' : 'üîä';
      playSound('click');
    });
    document.getElementById('toggleDetailsBtn').addEventListener('click', () => {
      const content = document.getElementById('detailsBreakdown');
      content.classList.toggle('collapsed');
      const btn = document.getElementById('toggleDetailsBtn');
      btn.textContent = content.classList.contains('collapsed') ? '‚ñº Show Detailed Breakdown' : '‚ñ≤ Hide Details';
      playSound('click');
    });
    let konamiIndex = 0;
    const konamiCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];
    document.addEventListener('keydown', e => {
      if (e.keyCode === konamiCode[konamiIndex]) {
        konamiIndex++;
        if (konamiIndex === konamiCode.length) {
          document.body.classList.toggle('summon-mode');
          konamiIndex = 0;
          playSound('beep');
        }
      } else {
        konamiIndex = 0;
      }
    });
    const prophecies = [
      "The gods whisper: Thy site loads like Hermes on wings‚Äîswift and divine! But beware the trackers lurking in shadows.",
      "Oracle decrees: P-Score favors the bold. Thy page weighs heavy as Sisyphus' boulder‚Äîlighten it!",
      "From Delphi's fumes: Accessibility reigns supreme. Make thy realm open to all, lest the Fates blind thee.",
      "Pythia laughs: SEO pulses strong, yet privacy? A sieve for secrets. Seal thy Helix!",
      "Verdict: Modern tech gleams like Athena's shield. But sustainability? The earth groans‚Äîgo green, mortal!"
    ];
    document.getElementById('consultBtn').addEventListener('click', () => {
      playSound('beep');
      const randomProphecy = prophecies[Math.floor(Math.random() * prophecies.length)];
      document.getElementById('consultationText').textContent = randomProphecy;
      document.getElementById('consultationResults').classList.remove('hidden');
    });
    document.getElementById('demoBtn').addEventListener('click', () => {
      playSound('click');
      fetch(TOP50_API).then(r => r.json()).then(data => {
        const randomSite = data.results[Math.floor(Math.random() * data.results.length)].url;
        document.getElementById('urlInput').value = randomSite;
        analyzeSite();
      }).catch(() => {
        document.getElementById('urlInput').value = 'https://www.google.com';
        analyzeSite();
      });
    });
    document.getElementById('exportBtn').addEventListener('click', () => {
      const blob = new Blob([JSON.stringify(currentData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'pythia-report.json';
      a.click();
      URL.revokeObjectURL(url);
      playSound('click');
    });
    document.getElementById('customBattleBtn').addEventListener('click', startBattleCustom);
    document.getElementById('shareRivalryBtn').addEventListener('click', shareBattle);

    function renderRivalries() {
      const list = document.getElementById('rivalryList');
      list.innerHTML = RIVALRIES.map(r => {
        return `<div class="rivalry-item flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-indigo-50 transition">
          <div class="flex-1">
            <div class="text-xs font-bold text-gray-500 mb-1">${r.category}</div>
            <div class="font-bold text-gray-800">${r.name1} v ${r.name2}</div>
          </div>
          <button onclick="startBattle('${r.url1}', '${r.url2}', '${r.name1}', '${r.name2}', '${r.logo1}', '${r.logo2}')" class="retro-button px-4 py-2 bg-red-500 text-white font-bold rounded-lg hover:bg-red-600 transition text-sm">‚öîÔ∏è</button>
        </div>`;
      }).join('');
    }

    async function startBattle(url1, url2, name1, name2, logo1, logo2) {
      playSound('beep');
      const btn = event.target;
      btn.innerHTML = '<span class="sword-fighting">‚öîÔ∏è</span>';
      btn.disabled = true;
      document.getElementById('battleResults').classList.add('hidden');
      
      try {
        const [data1, data2] = await Promise.all([
          getOrFetchScan(url1),
          getOrFetchScan(url2)
        ]);
        currentBattleData = { name1, name2, result1: data1, result2: data2, winner: data1.pscore > data2.pscore ? name1 : data2.pscore > data1.pscore ? name2 : 'TIE', battleDate: new Date().toLocaleString() };
        
        const winnerIcon = document.getElementById('winnerIcon');
        const winnerLogo = currentBattleData.winner === name1 ? logo1 : logo2;
        if (winnerLogo && currentBattleData.winner !== 'TIE') {
          winnerIcon.querySelector('img').src = winnerLogo;
          winnerIcon.classList.remove('hidden');
        } else {
          winnerIcon.classList.add('hidden');
        }
        
        document.getElementById('winnerAnnouncement').innerHTML = currentBattleData.winner === 'TIE' ? 'ü§ù IT\'S A TIE!<br><span class="text-2xl">P-Score‚Ñ¢: ' + data1.pscore + ' - ' + data2.pscore + '</span><br><span class="text-xs opacity-75 mt-2 block">' + currentBattleData.battleDate + '</span>' : 'üèÜ ' + currentBattleData.winner.toUpperCase() + ' IS THE WINNER!<br><span class="text-2xl">P-Score‚Ñ¢: ' + Math.max(data1.pscore, data2.pscore) + ' - ' + Math.min(data1.pscore, data2.pscore) + '</span><br><span class="text-xs opacity-75 mt-2 block">' + currentBattleData.battleDate + '</span>';
        
        document.getElementById('contestant1Results').innerHTML = '<div class="text-center"><div class="text-xl font-bold mb-2">' + name1 + '</div><div class="text-3xl font-bold text-indigo-600">' + data1.pscore + '</div><div class="text-sm font-bold mt-2">P-Score‚Ñ¢</div><div class="text-xs text-gray-500 mt-2">Speed: ' + data1.karpov + ' ‚Ä¢ Access: ' + data1.vortex + '<br>Scale: ' + data1.nova + ' ‚Ä¢ Tech: ' + data1.aether + '</div></div>';
        document.getElementById('contestant2Results').innerHTML = '<div class="text-center"><div class="text-xl font-bold mb-2">' + name2 + '</div><div class="text-3xl font-bold text-purple-600">' + data2.pscore + '</div><div class="text-sm font-bold mt-2">P-Score‚Ñ¢</div><div class="text-xs text-gray-500 mt-2">Speed: ' + data2.karpov + ' ‚Ä¢ Access: ' + data2.vortex + '<br>Scale: ' + data2.nova + ' ‚Ä¢ Tech: ' + data2.aether + '</div></div>';
        
        document.getElementById('battleResults').classList.remove('hidden');
      } catch (error) {
        alert('Battle failed: ' + error.message);
      } finally {
        btn.innerHTML = '‚öîÔ∏è';
        btn.disabled = false;
      }
    }

    async function getOrFetchScan(url) {
      let data = getCachedScan(url);
      if (!data) {
        const response = await fetch('/api/scan', { method: 'POST', body: JSON.stringify({ url }) });
        data = await response.json();
        setCachedScan(url, data);
      }
      return data;
    }

    function startBattleCustom() {
      const url1 = normalizeUrl(document.getElementById('customUrl1').value.trim());
      const url2 = normalizeUrl(document.getElementById('customUrl2').value.trim());
      if (!url1 || !url2) {
        alert('Please enter two valid URLs');
        return;
      }
      const name1 = new URL(url1).hostname;
      const name2 = new URL(url2).hostname;
      startBattle(url1, url2, name1, name2, '', '');
    }

    function shareBattle() {
      if (!currentBattleData) return;
      const { name1, name2, result1, result2, winner, battleDate } = currentBattleData;
      const text = `‚öîÔ∏è PYTHIA‚Ñ¢ BATTLE (${battleDate}): ${name1} (${result1.pscore}) v ${name2} (${result2.pscore}) - ${winner.toUpperCase()} WINS! üèÜ Scanned by Pythia‚Ñ¢ üîÆ #PScore`;
      shareContent(text, window.location.href);
    }

    function shareContent(text, url, platform) {
      const encodedText = encodeURIComponent(text);
      const encodedUrl = encodeURIComponent(url);
      let shareUrl;
      switch (platform) {
        case 'twitter': shareUrl = `https://twitter.com/intent/tweet?text=${encodedText}&url=${encodedUrl}`; break;
        case 'facebook': shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`; break;
        case 'whatsapp': shareUrl = `https://wa.me/?text=${encodedText}%20${encodedUrl}`; break;
        case 'email': shareUrl = `mailto:?subject=Pythia‚Ñ¢ Battle&body=${encodedText}%20${encodedUrl}`; break;
      }
      if (shareUrl) window.open(shareUrl, '_blank');
      playSound('click');
    }

    async function loadTop50Results() {
      try {
        const response = await fetch(TOP50_API);
        const data = await response.json();
        if (data.error) throw new Error(data.message);
        
        const sorted = data.results.sort((a, b) => b.pscore - a.pscore);
        const top5 = sorted.slice(0, 5);
        const bottom5 = sorted.slice(-5).reverse();
        
        document.getElementById('top50TopList').innerHTML = top5.map((site, i) => `<div class="leaderboard-entry flex justify-between items-center p-2 rounded bg-green-50"><span>${i + 1}. ${new URL(site.url).hostname}</span><span>P-Score: ${site.pscore}</span></div>`).join('');
        document.getElementById('top50BottomList').innerHTML = bottom5.map((site, i) => `<div class="leaderboard-entry flex justify-between items-center p-2 rounded bg-red-50"><span>${sorted.length - (4 - i)}. ${new URL(site.url).hostname}</span><span>P-Score: ${site.pscore}</span></div>`).join('');
        
        document.getElementById('top50Loading').classList.add('hidden');
        document.getElementById('top50Results').classList.remove('hidden');
      } catch (error) {
        document.getElementById('top50Loading').textContent = 'Failed to load: ' + error.message;
      }
    }

    async function loadEnterpriseDaily() {
      try {
        const response = await fetch(ENTERPRISE_API);
        const data = await response.json();
        if (data.error) throw new Error(data.message);
        
        document.getElementById('enterpriseWinner').textContent = new URL(data.winner.url).hostname;
        document.getElementById('enterprisePscore').textContent = data.winner.pscore;
        document.getElementById('enterpriseLoadTime').textContent = data.winner.loadTime;
        document.getElementById('enterpriseTotalScanned').textContent = `From ${data.totalScanned} sites scanned on ${data.scanDate}`;
        document.getElementById('enterpriseLink').href = data.winner.url;
        
        document.getElementById('enterpriseDailyLoading').classList.add('hidden');
        document.getElementById('enterpriseDailyResults').classList.remove('hidden');
      } catch (error) {
        document.getElementById('enterpriseDailyLoading').textContent = 'No scan available: ' + error.message;
      }
    }

    async function updateVisitCounter() {
      try {
        const response = await fetch(VISIT_API);
        const data = await response.json();
        document.getElementById('visitCount').textContent = data.count;
      } catch (error) {
        document.getElementById('visitCount').textContent = 'N/A';
      }
    }

    // Init
    renderRivalries();
    loadTop50Results();
    loadEnterpriseDaily();
    updateVisitCounter();
    showBootSequence();
  </script>
</html>
